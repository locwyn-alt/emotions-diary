<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–î–Ω–µ–≤–Ω–∏–∫ —ç–º–æ—Ü–∏–π</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 20px;
    }
    .filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
    }
    .filter-buttons button {
      flex: 1 1 calc(20% - 10px);
      min-width: 100px;
      padding: 10px;
      font-size: 14px;
      white-space: nowrap;
      border: none;
      border-radius: 8px;
      background-color: #e0e0e0;
      cursor: pointer;
    }
    .filter-buttons button.active {
      background-color: #a3d5ff;
    }
    .entry {
      background-color: #ffffff;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .entry h3 {
      margin: 0 0 10px;
      font-size: 16px;
    }
    .entry p {
      margin: 5px 0;
      font-size: 14px;
    }
  </style>
</head>
<body>

  <div class="filter-buttons" id="filters">
    <button data-filter="all" class="active">–í—Å–µ —ç–º–æ—Ü–∏–∏</button>
    <button data-filter="joy">üòä –†–∞–¥–æ—Å—Ç—å / –≤–æ—Å—Ç–æ—Ä–≥</button>
    <button data-filter="sadness">üò¢ –ì—Ä—É—Å—Ç—å / –ø–µ—á–∞–ª—å</button>
    <button data-filter="anger">üò† –ó–ª–æ—Å—Ç—å / –¥–æ—Å–∞–¥–∞</button>
    <button data-filter="fear">üò® –°—Ç—Ä–∞—Ö / —Ç—Ä–µ–≤–æ–≥–∞</button>
    <button data-filter="surprise">üòÆ –£–¥–∏–≤–ª–µ–Ω–∏–µ / –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ</button>
    <button data-filter="disgust">ü§¢ –ë—Ä–µ–∑–≥–ª–∏–≤–æ—Å—Ç—å / —Å–∫—É–∫–∞</button>
    <button data-filter="interest">üßê –û–∂–∏–¥–∞–Ω–∏–µ / –∏–Ω—Ç–µ—Ä–µ—Å</button>
    <button data-filter="trust">ü§ó –î–æ–≤–µ—Ä–∏–µ / –ø—Ä–∏–Ω—è—Ç–∏–µ</button>
  </div>

  <div id="entries"></div>

  <script>
    const apiUrl = "https://script.google.com/macros/s/AKfycbxng3-CbqTgqnC8euxI-H5FMTp8Rvj32ThnKvI04OOGrv5eGjPJbbkrXOF4Cv8wcjtrtQ/exec?action=get_emotions";

    let allEntries = [];

    fetch(apiUrl)
      .then(res => res.json())
      .then(data => {
        allEntries = data.entries || [];
        renderEntries("all");
      });

    function renderEntries(filter) {
      const container = document.getElementById("entries");
      container.innerHTML = "";

      const filtered = filter === "all" ? allEntries : allEntries.filter(e => e.emotion_id === filter);

      filtered.forEach(entry => {
        const el = document.createElement("div");
        el.className = "entry";
        el.innerHTML = `
          <h3>${getEmoji(entry.emotion_id)} ${entry.emotion_type}</h3>
          <p><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> ${entry.emotion_intens}</p>
          <p><strong>–°–∏—Ç—É–∞—Ü–∏—è:</strong> ${entry.emotion_context}</p>
          <p><strong>–†–µ–∞–∫—Ü–∏—è:</strong> ${entry.emotion_reflex}</p>
          <p><strong>–ú—ã—Å–ª–∏:</strong> ${entry.emotion_think}</p>
          <p><em>${entry.date}</em></p>
        `;
        container.appendChild(el);
      });
    }

    function getEmoji(id) {
      const map = {
        joy: "üòä", sadness: "üò¢", anger: "üò†", fear: "üò®",
        surprise: "üòÆ", disgust: "ü§¢", interest: "üßê", trust: "ü§ó"
      };
      return map[id] || "üüä";
    }

    document.querySelectorAll(".filter-buttons button").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".filter-buttons button").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        renderEntries(btn.dataset.filter);
      });
    });
  </script>

</body>
</html>
